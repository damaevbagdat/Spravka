# Генератор справок о ссудной задолженности

## SwissCapital - Республика Казахстан

Система для массовой генерации справок о ссудной задолженности с поддержкой до 1000 клиентов.

---

## Структура проекта

```
Справка о задолженности/
├── assets/                         # Логотип и ресурсы
├── data/
│   └── clients_data.xlsx           # Шаблон данных клиентов
├── output/                         # Сгенерированные справки
├── excel_pure/
│   └── CertificateFormulas.xlsx    # Вариант 1: Чистый Excel
├── excel_vba/
│   ├── CertificateGenerator_BASE.xlsx
│   └── VBA_Code.bas                # Вариант 2: Excel + VBA
├── scripts/
│   ├── generate_certificates.py    # Вариант 3: Python
│   └── num2text.py                 # Модуль перевода чисел
└── README.md
```

---

## Входные данные

| Поле | Тип | Обязательное |
|------|-----|--------------|
| Номер договора | Текст | Да |
| Дата договора | Дата | Да |
| ФИО клиента | Текст | Да |
| Основной долг | Число | Да |
| Вознаграждение | Число | Да |
| Отсроченные проценты | Число | Нет* |
| Пеня за ОД | Число | Нет* |
| Пеня за вознаграждение | Число | Нет* |
| Гос.пошлина | Число | Нет* |
| Административные сборы | Число | Нет* |

> *Условные поля: отображаются только если значение > 0

---

## Вариант 1: Чистый Excel

**Файл:** `excel_pure/CertificateFormulas.xlsx`

### Как использовать:

1. Откройте файл `CertificateFormulas.xlsx`
2. Перейдите на лист **"Данные"** и заполните данные клиентов
3. На листе **"Настройки"** укажите:
   - Номер клиента (из столбца №)
   - Дату отчёта
   - ФИО менеджера
4. Перейдите на лист **"Справка"** — данные подтянутся автоматически
5. Печать: Ctrl+P

### Особенности:
- Без макросов
- Просмотр по одному клиенту
- Условные строки скрываются автоматически

---

## Вариант 2: Excel + VBA (Рекомендуется)

**Файлы:** `excel_vba/`

### Первоначальная настройка:

1. Откройте `CertificateGenerator_BASE.xlsx` в Excel
2. Нажмите **Alt+F11** (редактор VBA)
3. В меню: **Insert → Module**
4. Откройте файл `VBA_Code.bas` в блокноте и скопируйте весь код
5. Вставьте код в окно модуля
6. Сохраните как `.xlsm`: **Файл → Сохранить как → Книга Excel с поддержкой макросов**

### Как использовать:

1. Откройте `.xlsm` файл (разрешите макросы!)
2. Заполните данные на листе **"Данные"**
3. На листе **"Настройки"** укажите дату и ФИО менеджера
4. **Генерация справок:**
   - Нажмите **Alt+F8**
   - Выберите **GenerateAllCertificates**
   - Нажмите **Выполнить**
5. **Экспорт в PDF:**
   - Нажмите **Alt+F8**
   - Выберите **ExportAllToPDF**
   - Выберите папку для сохранения

### Особенности:
- Массовая генерация (до 1000 справок)
- Экспорт в PDF
- Каждая справка на отдельном листе

---

## Вариант 3: Python

**Файлы:** `scripts/`

### Установка:

```bash
pip install openpyxl
```

### Как использовать:

1. Заполните данные в `data/clients_data.xlsx`
2. Откройте терминал в папке проекта
3. Запустите скрипт:

```bash
# Генерация Excel справок
python scripts/generate_certificates.py --date "22.12.2025" --format excel

# С указанием файла данных
python scripts/generate_certificates.py --data "data/clients_data.xlsx" --date "22.12.2025"

# Изменить менеджера
python scripts/generate_certificates.py --date "22.12.2025" --manager "Иванова А.Б."
```

### Параметры:

| Параметр | Описание | По умолчанию |
|----------|----------|--------------|
| `--data`, `-d` | Путь к файлу данных | `data/clients_data.xlsx` |
| `--date`, `-t` | Дата отчёта (DD.MM.YYYY) | Обязательный |
| `--format`, `-f` | Формат вывода: excel/pdf/both | excel |
| `--manager`, `-m` | ФИО менеджера | Койбасова Е.Б. |

### Результат:
Справки сохраняются в `output/batch_DD-MM-YYYY/`

### Особенности:
- Максимальная гибкость
- Командная строка
- Легко интегрировать в автоматизацию

---

## Формат справки

```
┌─────────────────────────────────────────────────────────┐
│                    swisscapital                         │
│     Республика Казахстан, г.Алматы, 050026              │
│     ул. Нурмакова д.93А. тел +7(727)3550771.            │
├─────────────────────────────────────────────────────────┤
│           Расчет ссудной задолженности                  │
├─────────────────────────────────────────────────────────┤
│  По договору займа №... от ..., заключенному с ...,     │
│  по состоянию на ... ссудная задолженность составляет   │
│  X XXX XXX (прописью) тенге, из них:                    │
│                                                         │
│  ➤ Основной долг - X XXX XXX (прописью) тенге;          │
│  ➤ Вознаграждение – X XXX (прописью) тенге;             │
│  ➤ [условно] Неустойка – X XXX тенге;                   │
│  ➤ [условно] Другие поля...                             │
├─────────────────────────────────────────────────────────┤
│  Операционный менеджер                   Койбасова Е.Б. │
└─────────────────────────────────────────────────────────┘
```

---

## Числа прописью

Система автоматически переводит числа в текст на русском языке:

| Число | Прописью |
|-------|----------|
| 7 652 278 | семь миллионов шестьсот пятьдесят две тысячи двести семьдесят восемь |
| 6 551 320 | шесть миллионов пятьсот пятьдесят одна тысяча триста двадцать |
| 799 832 | семьсот девяносто девять тысяч восемьсот тридцать два |

---

## Сравнение вариантов

| Критерий | Чистый Excel | Excel + VBA | Python |
|----------|--------------|-------------|--------|
| Массовая генерация | Нет | Да | Да |
| Экспорт в PDF | Вручную | Да | Да* |
| Без установки | Да | Да | Нет |
| Автоматизация | Нет | Нет | Да |
| Сложность | Простой | Средний | Средний |

> *PDF генерация в Python требует дополнительных библиотек

---

## Автор

SwissCapital - Система генерации справок
Версия 1.0 | Декабрь 2025
